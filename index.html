<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Freyescert.GitHub.io by freyescert</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Freyescert.GitHub.io</h1>
      <h2 class="project-tagline"></h2>
    </section>

    <section class="main-content">
      <h3>
<a id="powershell-examples" class="anchor" href="#powershell-examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Powershell Examples</h3>

<p>Repository for all the powershell scripts i've designed or adapted from the internet.</p>

<h2>
<a id="bginfoinstallps1" class="anchor" href="#bginfoinstallps1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>bginfoinstall.ps1</h2>

<p>This script will automatically setup bginfo to run from startup and create a registry key to have bginfo to run your predefined config file.</p>

<p>You will need to log on and off for the changes to apply. This will also affect all users who log into the computer.</p>

<pre><code>#BGInfo Install
New-Item -ItemType Directory -Force -Path C:\Powershell\Logs #Creating Log Directory
Start-Transcript -Path "C:\Powershell\logs\BgInfo_Installer__$(get-date -f MM-dd-yyyy).txt" #Creates Transcript for Auditing

if (Test-Path "C:\bginfo")
{ remove-item -path "C:\bginfo" -Recurse }

copy-item \\YourServer\Software\BGInfo -Destination C:\BgInfo -Recurse -Verbose

Set-ItemProperty -path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" -name "BgInfo" -value  "C:\bginfo\Bginfo.exe C:\bginfo\YourConfig.bgi /TIMER:0 /NOLICPROMPT" -Verbose

Write-Host BGInfo Installed -ForegroundColor Green -BackgroundColor Black

Stop-Transcript
</code></pre>

<h2>
<a id="configure-ip-and-join-domain" class="anchor" href="#configure-ip-and-join-domain" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configure IP and Join Domain</h2>

<p>Simple script that does the following</p>

<ol>
<li>Assign IP, Subnet Mask, DNS</li>
<li>Disable the builtin Windows Firewall</li>
<li>Enable remote desktop connections</li>
<li>Rename computer and join to the domain.</li>
</ol>

<pre><code> &lt;#
.Synopsis
   Configures IP and joins to domain
.DESCRIPTION
   Configures Ethernet Adapter 1's IP
   Renames Computer
   Joins Computer to Domain
   All commands will be transcripted.
.NOTES
   You will need network connectivity
   You will need to define the Variables.
#&gt;
#requires â€“runasadministrator

$IF = "12" # You may need to change this if the Interface Index is different on your computer.
$IP = "ip Goes here"
$MaskBits = 24 # This means subnet mask = 255.255.255.0
$Gateway = "Gateway"
$DNS = "1"
$IPType = "IPv4"
$Name = "ComputerName"
$Domain = "YourDomain.COM" 
$OU = "OU=Your OU goes here" #OU Path if needed

#Start of Script
New-Item -ItemType Directory -Force -Path C:\Powershell\Logs
Start-Transcript -Path "C:\powershell\logs\Configure_IP_Join_Domain_$(Get-Date -f MM-dd-yyyy).txt"

#configuring adapter
New-NetIPAddress -InterfaceIndex $IF -AddressFamily $IPType -IPAddress $IP -PrefixLength $MaskBits -DefaultGateway $Gateway -Verbose
Set-DnsClientServerAddress -InterfaceIndex $IF -ServerAddresses $DNS -Verbose
Write-Host Configured Network Adapter with ip of $IP

#disable firewall enable remote desktop
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server'-name "fDenyTSConnections" -Value 0 -Verbose
Enable-NetFirewallRule -DisplayGroup "Remote Desktop" -Verbose
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "UserAuthentication" -Value 1 -Verbose

#join to domain and restart
Add-Computer -DomainName $Domain -NewName $Name -OUPath $OU -Verbose -Restart
</code></pre>

      <footer class="site-footer">

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
