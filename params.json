{
  "name": "Freyescert.GitHub.io",
  "tagline": "",
  "body": "### Powershell Examples\r\n\r\nRepository for all the powershell scripts i've designed or adapted from the internet.\r\n\r\n## bginfoinstall.ps1\r\n\r\nThis script will automatically setup bginfo to run from startup and create a registry key to have bginfo to run your predefined config file.\r\n\r\nYou will need to log on and off for the changes to apply. This will also affect all users who log into the computer.\r\n\r\n```\r\n#BGInfo Install\r\nNew-Item -ItemType Directory -Force -Path C:\\Powershell\\Logs #Creating Log Directory\r\nStart-Transcript -Path \"C:\\Powershell\\logs\\BgInfo_Installer__$(get-date -f MM-dd-yyyy).txt\" #Creates Transcript for Auditing\r\n\r\nif (Test-Path \"C:\\bginfo\")\r\n{ remove-item -path \"C:\\bginfo\" -Recurse }\r\n\r\ncopy-item \\\\YourServer\\Software\\BGInfo -Destination C:\\BgInfo -Recurse -Verbose\r\n \r\nSet-ItemProperty -path \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" -name \"BgInfo\" -value  \"C:\\bginfo\\Bginfo.exe C:\\bginfo\\YourConfig.bgi /TIMER:0 /NOLICPROMPT\" -Verbose\r\n\r\nWrite-Host BGInfo Installed -ForegroundColor Green -BackgroundColor Black\r\n\r\nStop-Transcript\r\n```\r\n\r\n##Configure IP and Join Domain\r\n\r\nSimple script that does the following\r\n\r\n1. Assign IP, Subnet Mask, DNS\r\n2. Disable the builtin Windows Firewall\r\n3. Enable remote desktop connections\r\n4. Rename computer and join to the domain.\r\n\r\n```\r\n <#\r\n.Synopsis\r\n   Configures IP and joins to domain\r\n.DESCRIPTION\r\n   Configures Ethernet Adapter 1's IP\r\n   Renames Computer\r\n   Joins Computer to Domain\r\n   All commands will be transcripted.\r\n.NOTES\r\n   You will need network connectivity\r\n   You will need to define the Variables.\r\n#>\r\n#requires â€“runasadministrator\r\n\r\n$IF = \"12\" # You may need to change this if the Interface Index is different on your computer.\r\n$IP = \"ip Goes here\"\r\n$MaskBits = 24 # This means subnet mask = 255.255.255.0\r\n$Gateway = \"Gateway\"\r\n$DNS = \"1\"\r\n$IPType = \"IPv4\"\r\n$Name = \"ComputerName\"\r\n$Domain = \"YourDomain.COM\" \r\n$OU = \"OU=Your OU goes here\" #OU Path if needed\r\n\r\n#Start of Script\r\nNew-Item -ItemType Directory -Force -Path C:\\Powershell\\Logs\r\nStart-Transcript -Path \"C:\\powershell\\logs\\Configure_IP_Join_Domain_$(Get-Date -f MM-dd-yyyy).txt\"\r\n\r\n#configuring adapter\r\nNew-NetIPAddress -InterfaceIndex $IF -AddressFamily $IPType -IPAddress $IP -PrefixLength $MaskBits -DefaultGateway $Gateway -Verbose\r\nSet-DnsClientServerAddress -InterfaceIndex $IF -ServerAddresses $DNS -Verbose\r\nWrite-Host Configured Network Adapter with ip of $IP\r\n\r\n#disable firewall enable remote desktop\r\nSet-NetFirewallProfile -Profile Domain,Public,Private -Enabled False\r\nSet-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server'-name \"fDenyTSConnections\" -Value 0 -Verbose\r\nEnable-NetFirewallRule -DisplayGroup \"Remote Desktop\" -Verbose\r\nSet-ItemProperty -Path 'HKLM:\\System\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp' -name \"UserAuthentication\" -Value 1 -Verbose\r\n\r\n#join to domain and restart\r\nAdd-Computer -DomainName $Domain -NewName $Name -OUPath $OU -Verbose -Restart\r\n```\r\n\r\n## Links\r\n[My Linkedin](https://www.linkedin.com/in/freyesjr)",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}